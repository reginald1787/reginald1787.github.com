	<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Test for independence | 掖垣十寻</title>
  <meta name="author" content="Li">
  
  <meta name="description" content="AbstractARMA Process is a widely used model of time series, which has a lot of good properties. We will show in this article that, by testing the residual of a sequence, we can test whether or not ARMA model can be applied.The most important part is to build a test statistic of white with Ljung-Box method.
BackgroundConsider a real valued time series $(Z_{k})_{k\in \mathbb{Z}}$, we want to build a statistical test of the hypothesis$$ H_{0}={(Z_{k})_{k\in \mathbb{Z}} \mbox{is a white noise}}$$against$$ H_{1}={(Z_{k})_{k\in \mathbb{Z}} \mbox{is not a white noise}}$$
Let $\hat{\mu}_n$ be the empirical mean, $\hat{\gamma}_n$ be the empirical autocovariance function, $\hat{\rho}_n$ be the empirical autocorrelation function:
$$\hat{\gamma}=n^{-1}\sigma_{1\leq s,s+t\leq n}(Z_s-\hat{\mu}_n)(Z_{s+t}-\hat{\mu}_n)$$$$\hat{\rho}_n=\frac{\hat{\gamma}_n}{\gamma}$$
The Ljung-Box statistical test at lag $h&amp;gt;1$ is then defined as
$$ T_n(h)=n(n+2)\sum_{t=1}^{h}\frac{\hat{(\rho}_n(t))^2}{n-t} $$
We now do this step by step.">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="Test for independence"/>
  <meta property="og:site_name" content="掖垣十寻"/>

  
  
		<!-- favicon -->
		<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
		<link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
		<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
		<link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
		<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
		<link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
		<link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
		<link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
		<link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
		<link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
		<link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
		<link rel="manifest" href="/manifest.json">
		<meta name="msapplication-TileColor" content="#009688">
		<meta name="msapplication-TileImage" content="/mstile-144x144.png">
		<meta name="theme-color" content="#009688">
		<!-- favicon end -->
    <!-- <link href="/favicon.ico" rel="icon"> -->
  

  <!-- toc -->
  <link rel="stylesheet" href="/libs/tocify/jquery.tocify.css" media="screen" type="text/css">

  <!-- <link rel="stylesheet" href="/libs/bs/css/bootstrap.min.css" media="screen" type="text/css"> -->
  <link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap/3.3.4/css/bootstrap.min.css" media="screen" type="text/css">

  <!-- material design -->
	<!-- <link rel="stylesheet" href="/libs/bs-material/css/ripples.min.css" media="screen" type="text/css"> -->
  <link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap-material/0.3.0/css/ripples.min.css" media="screen" type="text/css">
  <!-- <link rel="stylesheet" href="/libs/bs-material/css/material.min.css" media="screen" type="text/css"> -->
	<link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap-material/0.3.0/css/material.min.css" media="screen" type="text/css">

  <link rel="stylesheet" href="/css/highlight.light.css" media="screen" type="text/css">

  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">

  

  

  <script src="//apps.bdimg.com/libs/jquery/2.0.3/jquery.min.js"></script>
	<script>window.jQuery || document.write('<script src="/libs/jquery-2.0.3.min.js" type="text/javascript"><\/script>')</script>

</head>

 	<body>
	  <nav class="navbar navbar-default">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">菜单</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">掖垣十寻</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
            <ul class="nav navbar-nav navbar-right">
                
                <li>
                    <a href="/" title="">
                    <i class="fa fa-home"></i>首页
                    </a>
                </li>
                
                <li>
                    <a href="/archives" title="">
                    <i class="fa fa-list"></i>存档
                    </a>
                </li>
                
                <li>
                    <a href="/about" title="">
                    <i class="fa fa-info-circle"></i>关于
                    </a>
                </li>
                
                <li>
                    <a href="/atom.xml" title="这是一个订阅源">
                    <i class="fa fa-rss"></i>RSS
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</nav>

	  <div class="container" >
	    <div class="row">
	
	<div class="col-md-9 center-content">
	

		<div class="content">
			<!-- index -->
		   

			  		<h2>Test for independence</h2>
					
					<div>
						<span class="post-time">2014-03-27 17:41:17</span>
					</div>	
					

					<div class="article-content">
						<h1 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h1><p>ARMA Process is a widely used model of time series, which has a lot of good properties. We will show in this article that, by testing the residual of a sequence, we can test whether or not ARMA model can be applied.<br>The most important part is to build a test statistic of white with Ljung-Box method.</p>
<h1 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h1><p>Consider a real valued time series $(Z_{k})_{k\in \mathbb{Z}}$, we want to build a statistical test of the hypothesis<br>$$ H_{0}={(Z_{k})_{k\in \mathbb{Z}} \mbox{is a white noise}}$$<br>against<br>$$ H_{1}={(Z_{k})_{k\in \mathbb{Z}} \mbox{is not a white noise}}$$</p>
<p>Let $\hat{\mu}_n$ be the empirical mean, $\hat{\gamma}_n$ be the empirical autocovariance function, $\hat{\rho}_n$ be the empirical autocorrelation function:</p>
<p>$$\hat{\gamma}=n^{-1}\sigma_{1\leq s,s+t\leq n}(Z_s-\hat{\mu}_n)(Z_{s+t}-\hat{\mu}_n)$$<br>$$\hat{\rho}_n=\frac{\hat{\gamma}_n}{\gamma}$$</p>
<p>The Ljung-Box statistical test at lag $h&gt;1$ is then defined as</p>
<p>$$ T_n(h)=n(n+2)\sum_{t=1}^{h}\frac{\hat{(\rho}_n(t))^2}{n-t} $$</p>
<p>We now do this step by step.</p>
<a id="more"></a>
<h2 id="Step-1"><a href="#Step-1" class="headerlink" title="Step 1"></a>Step 1</h2><p>Under $H_{0}$ and assuming moreover that $E[Z_{0}^{4}]&lt;\infty$, show that the asymptotic distribution of $T_n(h)$ as $n\rightarrow$ is $\chi^2_h$.</p>
<p>Proof:</p>
<blockquote>
<p>Under these assumptions, we can get:<br>$$ \sqrt{n}(\hat{\rho}_{n}-\rho)\Rightarrow\mathcal{N}(0,W) $$<br>since $\rho(j)=0$ for all $j\neq 0$<br>we have:<br>$$ \sqrt{n}\hat{\rho}_{n}(t)\Rightarrow\mathcal{N}(0,1) $$<br>furthermore, since<br>$$ \frac{n+2}{n-t}\xrightarrow{P}1 $$<br>By applying Slutsky’s Lemma, we get<br>$$ n(n+2)\frac{\hat{(\rho}_n(t))^2}{n-t}\Rightarrow\chi^2,\mbox{for all } t&gt;0 $$<br>Thus, the conclusion is achieved:<br>$$ n(n+2)\sum_{t=1}^{h}\frac{\hat{(\rho}_n(t))^2}{n-t}\Rightarrow\chi^2_{h} $$</p>
</blockquote>
<h2 id="Step-2"><a href="#Step-2" class="headerlink" title="Step 2"></a>Step 2</h2><p>If $(Z_{k})_{k\in \mathbb{Z}}$ is an MA(1) process,<br>show that for all $m&gt;0$, $\lim_{n\rightarrow\infty}\mathbb{P}(T_n(h)&gt;m)=1$</p>
<blockquote>
<p>We first have<br>$$ \hat{\gamma}_{n}(t)=\gamma(t)+O_P(n^{-1/2}) $$<br>Now we want to prove for any $m&gt;0$<br>$$\lim_{n\to\infty} P(\sqrt{n}\hat{\gamma}_{n}(t)+O_p(1)&gt;m(\hat{\gamma}_{n}(0)+O_p(n^{-1/2}))) = 1, t&gt;0$$<br>Since $m O_p(n^{-1/2})$is $O_p(n^{-1/2})$, and obviously it is $O_p(1)$, we just need to prove that<br>$$\lim_{n\to\infty} P(\sqrt{n}\hat{\gamma}_{n}(t)+O_p(1)&gt;m\hat{\gamma}_{n}(0)) = 1, t&gt;0$$<br>for big enough $n$, we have<br>$$\lim_{n\to\infty} P(O_p(1)&gt;|\sqrt{n}\hat{\gamma}_{n}(t)-m\hat{\gamma}_{n}(0)|)=0, t&gt;0$$<br>then for arbitrary $\epsilon&gt;0$, we have a $N$, for any $n&gt;N$, we have<br>$$P(O_p(1)&gt;|\sqrt{n}\hat{\gamma}_{n}(t)-m\hat{\gamma}_{n}(0)|)&lt;\epsilon$$</p>
</blockquote>
<p>With this conclusion, we can get<br>$$\lim_{n\to\infty} P(T_n(h)&gt;(n-2)\sum_{t=1}^h\frac{m^2}{n-t}) = 1$$<br>which is equivalent to:<br>$$\lim_{n\to\infty} P(T_n(h)&gt;m) = 1$$</p>
<h2 id="Step-3"><a href="#Step-3" class="headerlink" title="Step 3"></a>Step 3</h2><p>Propose a test of $H_0$ relying on the statistic $T_n(h)$ and on the quantile function of the $\chi_n^2$</p>
<blockquote>
<p>Since under assumption $H_0$, $T_n(h)$ accords with $\chi^2_h$, we can test $H_0$ by test the value of $T_n(h)$:</p>
<blockquote>
<p>suppose $F(x)$ is the cumulative function of $\chi^2_h$, given a significance value $\alpha$(0.01,0.05,etc.), if<br>$$p:=1-F(T_n(h))&lt;\alpha$$<br>we can refuse $H_0$, otherwise, we can keep it.</p>
</blockquote>
</blockquote>
<h2 id="Step-4"><a href="#Step-4" class="headerlink" title="Step 4"></a>Step 4</h2><p>Since $(X_{k})_{k\in \mathbb{Z}}$ is an AR(1) process, by Yule-Walker equations, we can solve that the best liner predictor of $X_t$ is:<br>    $$X_t=\gamma(1)X_{t-1},$$<br>where $\gamma(t)$ is the autocovariance function of $(X_{k})_{k\in \mathbb{Z}}$.</p>
<p>$\hat{\phi}=\frac{\sum_{k=2}^n X_k X_{k-1}}{\sum_{k=2}^n X_{k-1} X_{k-1}}$ provides an estimation of $\gamma(1)$.<br>Thus the residual $Z_k=X_k-\phi X_{k-1}$ is a white noise. we can run Ljung-Box test on it to test if $X$ is an AR(1) process or not.</p>
<h2 id="Step-5"><a href="#Step-5" class="headerlink" title="Step 5"></a>Step 5</h2><p>We simulate an AR(1) process and run the Ljung-Box test on it and its residuals with respect to different $h$, the p-values we get are showed below:</p>
<p><img src="https://drive.google.com/uc?export=view&amp;id=0B2LZQ72QPejMNU1JVzItV2daTk0" alt=""></p>
<p>we do the same procedure on a MA(1) process, the p-values are shown below:</p>
<p><img src="https://drive.google.com/uc?export=view&amp;id=0B2LZQ72QPejMS1JUb0xPbFB1cGM" alt=""></p>
<h2 id="Step-6"><a href="#Step-6" class="headerlink" title="Step 6"></a>Step 6</h2><p>Distributions of p-values obtained from the original AR(1)process:</p>
<p><img src="https://drive.google.com/uc?export=view&amp;id=0B2LZQ72QPejMWUU1bHVKakIwU1E" alt=""></p>
<p>Distributions of p-values obtained from the residual of the AR(1)process:</p>
<p><img src="https://drive.google.com/uc?export=view&amp;id=0B2LZQ72QPejMQ2ZzcDJkLWoyNGc" alt=""></p>
<p>We can see that p-value of the residual of AR(1) process obeys </p>
<p>Distributions of p-values obtained from the original MA(1)process:</p>
<p><img src="https://drive.google.com/uc?export=view&amp;id=0B2LZQ72QPejMNFZQemlBSUQwUm8" alt=""></p>
<p>We can see obviously that the p-value is mostly likely to be 0, as predicted by Question2.</p>
<p>Distributions of p-values obtained from the residual of the MA(1)process:</p>
<p><img src="https://drive.google.com/uc?export=view&amp;id=0B2LZQ72QPejMQ2ZzcDJkLWoyNGc" alt=""></p>
<h2 id="Step-7"><a href="#Step-7" class="headerlink" title="Step 7"></a>Step 7</h2><p>$$ \hat{\phi}=\arg\min_{\phi\in\mathbb{R} }\sum_{k=2}^n(X_k-\sum_{j=1}^p u_j X_{k-1}),$$<br>where $\phi=[u_1,u_2,\cdots,u_p]$.</p>
<p>To calculate $\hat{\phi}$, we differentiate above equation<br>with respect to $u_j$, and we get Yule-Walker equations.<br>$$\Gamma_p\phi=\gamma_p$$<br>where</p>
<p>\begin{aligned}<br>\Gamma_p&amp;=Cov([X_{t-1}\cdots X_{t-p}]^T)^T\\<br>&amp;=\begin{bmatrix}<br>\gamma(0)&amp;\gamma(-1)&amp;\cdots&amp;\gamma(-p+1)\\<br>\gamma(1)&amp;\gamma(0)&amp;\gamma(-1)&amp;\vdots\\<br>\vdots&amp;\ddots&amp;\ddots&amp;\\<br>\gamma(p-1)&amp;\gamma(p-2)&amp;\cdots&amp;\gamma(0)\\<br>\end{bmatrix}\\<br>\gamma_p&amp;=[\gamma(1)\gamma(2)\cdots\gamma(p)]^T<br>\end{aligned}</p>
<p>We can estimate $\gamma(p)$ by$\frac{\sum_{k=p+1}^n X_k X_{k-p}}{\sum_{k=p+1}^n X_{k-p} X_{k-p}}$.</p>
<h2 id="Step-8"><a href="#Step-8" class="headerlink" title="Step 8"></a>Step 8</h2><p>The data of GNP we used are as:</p>
<p><img src="https://drive.google.com/uc?export=view&amp;id=0B2LZQ72QPejMVXVpZ0Q2Q3NZV00" alt=""></p>
<p>We take $X_{t}$ to be $log(G_t)-log(G_{t-1})$</p>
<p><img src="https://drive.google.com/uc?export=view&amp;id=0B2LZQ72QPejMQmRTNktPNlhGTXc" alt=""></p>
<h2 id="Step-9"><a href="#Step-9" class="headerlink" title="Step 9"></a>Step 9</h2><table><br><tr><br><td> p </td><td> 1 </td><td> 2 </td><td> 3 </td><td> 4<br></td></tr><br><br><tr><br><td>p-value </td><td> 0.0369 </td><td> 0.0341</td><td>0.0765 </td><td> 0.0573<br></td></tr><br></table>

<p>from the table above, we can see that when $p$ takes value of 3, we get the biggest p-value. When p-value is bigger, we are more confident to say the residual accords with white noise,  which implies the original process corresponds better to AR model. So we take $p$ to be 3 in Step 10 to predict future data.</p>
<h2 id="Step-10"><a href="#Step-10" class="headerlink" title="Step 10"></a>Step 10</h2><p>The prediction we got when ($p=3$) compared with observations are shown below:</p>
<p><img src="https://drive.google.com/uc?export=view&amp;id=0B2LZQ72QPejMR0lOaW5EOXg5OFE" alt=""></p>
<p>One can see that, at the beginning, our prediction has the similar trend. But when $T=70$(2008), the observation drops dramatically, which can not be predicted from the past.</p>

					</div>

			  <!-- about -->
			  
		</div>

		<!-- pagination -->
	  

		<div class="comment-section">
  
  


</div>
	</div>

	

</div>


		<footer>
			

<p>
  由 <a href="https://hexo.io">hexo</a> 强力驱动 | 搭载 <a href="https://github.com/wayou/hexo-theme-material">material</a> 主题
</p>
<p>
  &copy; 2016 <a href="http://yoursite.com"> Li </a>
</p>
<a id="gotop" href="#" title="back to top"><i class="mdi-hardware-keyboard-arrow-up"></i></a>

		</footer>
	  </div>

		<!-- <script src="/libs/bs/js/bootstrap.min.js"></script> -->
		<script src="//apps.bdimg.com/libs/bootstrap/3.3.4/js/bootstrap.min.js"></script>
		<script>(typeof $().modal == 'function')|| document.write('<script src="/libs/bs/js/bootstrap.min.js" type="text/javascript"><\/script>')</script>

		<!-- material design -->
		<!-- <script src="/libs/bs-material/js/ripples.min.js"></script> -->
		<script src="//apps.bdimg.com/libs/bootstrap-material/0.3.0/js/ripples.min.js"></script>
		<!-- <script src="/libs/bs-material/js/material.min.js"></script> -->
		<script src="//apps.bdimg.com/libs/bootstrap-material/0.3.0/js/material.min.js"></script>
		<!-- toc -->
		<!-- <script src="/libs/tocify/jquery-ui.min.js"></script> -->
		<script src="//apps.bdimg.com/libs/jqueryui/1.10.4/jquery-ui.min.js"></script>
		<script src="/libs/tocify/jquery.tocify.custom.js"></script>

		<script src="/js/main.js"></script>

	</body>
</html>
